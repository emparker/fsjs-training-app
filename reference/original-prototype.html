<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Training Ground</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/editor/editor.main.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        .dark {
            background-color: #1a1a2e;
            color: #e9ecef;
        }
        
        .light {
            background-color: #f8f9fa;
            color: #212529;
        }
        
        .card-flip {
            animation: flipCard 0.6s ease-in-out;
        }
        
        @keyframes flipCard {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0deg); }
        }
        
        .streak-fire {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .code-editor {
            font-family: 'Fira Code', 'JetBrains Mono', monospace;
            background: #2d2d3d;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        
        .success-animation {
            animation: success 0.5s ease-out;
        }
        
        @keyframes success {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .monaco-container {
            border: 1px solid #4ecca3;
            border-radius: 8px;
            overflow: hidden;
            min-height: 200px;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // Sample question bank
        const questionBank = [
            {
                id: 1,
                type: "multipleChoice",
                difficulty: "easy",
                category: "javascript",
                topic: "variables",
                question: "What keyword declares a block-scoped variable that can be reassigned?",
                options: ["var", "let", "const", "function"],
                correctAnswer: "let",
                explanation: "The 'let' keyword declares a block-scoped variable that can be reassigned, unlike 'const' which cannot be reassigned.",
                analogy: "Think of 'let' like a labeled box where you can change what's inside, while 'const' is like a sealed container.",
                teachingTip: "Show students how 'let' prevents the common 'var' pitfalls in loops and helps avoid accidental global variables."
            },
            {
                id: 2,
                type: "multipleChoice",
                difficulty: "advanced",
                category: "javascript",
                topic: "closures",
                question: "What will this code output?",
                codeSnippet: `for (var i = 0; i < 3; i++) {
  setTimeout(() => console.log(i), 100);
}`,
                options: ["0 1 2", "3 3 3", "undefined undefined undefined", "Error"],
                correctAnswer: "3 3 3",
                explanation: "Because 'var' is function-scoped, all three setTimeout callbacks share the same 'i' variable. By the time they execute, the loop has finished and i equals 3.",
                analogy: "It's like three people taking photos of the same whiteboard - they all capture it at the same moment after someone has finished writing '3' on it.",
                teachingTip: "Use this example to demonstrate why 'let' is preferred in loops - it creates a new binding for each iteration."
            },
            {
                id: 3,
                type: "codeCompletion",
                difficulty: "easy",
                category: "react",
                topic: "hooks",
                question: "Complete this React Hook to manage state:",
                codeSnippet: `const [count, setCount] = ________(0);`,
                correctAnswer: "useState",
                explanation: "useState is the fundamental React Hook for adding state to functional components.",
                analogy: "useState is like giving your component a memory - it remembers values between re-renders.",
                teachingTip: "Always emphasize that hooks must be called at the top level of the component, not inside conditions or loops."
            },
            {
                id: 4,
                type: "debugging",
                difficulty: "medium",
                category: "javascript",
                topic: "errors",
                question: "A student's code throws 'Cannot read property of undefined'. What's the most likely cause?",
                codeSnippet: `const user = fetchUser();
console.log(user.name);`,
                correctAnswer: "The fetchUser() function is likely asynchronous and returns a Promise, not the user object directly",
                explanation: "When dealing with asynchronous operations, the function returns a Promise immediately, not the actual data. You need to use async/await or .then() to access the resolved value.",
                analogy: "It's like ordering food delivery - you get a receipt (Promise) immediately, but you can't eat the receipt. You need to wait for the actual food to arrive.",
                teachingTip: "Show students how to identify async operations and always check if a value exists before accessing its properties."
            },
            {
                id: 5,
                type: "studentQuestion",
                difficulty: "medium",
                category: "react",
                topic: "keys",
                question: "A student asks: 'Why do I need keys in React lists?'",
                correctAnswer: "Keys help React identify which items have changed, been added, or removed. This optimizes rendering performance by allowing React to update only the changed elements instead of re-rendering the entire list.",
                explanation: "React uses keys to track list items across re-renders, maintaining component state and improving performance.",
                analogy: "Keys are like name tags at a conference - they help React quickly identify who's who, even if people move around or new people join.",
                teachingTip: "Demonstrate with a practical example showing list re-ordering with and without keys, highlighting the visual glitches that occur without proper keys."
            },
            {
                id: 6,
                type: "multipleChoice",
                difficulty: "easy",
                category: "javascript",
                topic: "arrays",
                question: "Which array method creates a new array with all elements that pass a test?",
                options: ["map()", "filter()", "reduce()", "forEach()"],
                correctAnswer: "filter()",
                explanation: "The filter() method creates a new array containing only elements that return true for the provided testing function.",
                analogy: "filter() is like a bouncer at a club - only the elements that meet the criteria get into the new array.",
                teachingTip: "Show the difference between filter() and map() - filter changes the length, map changes the contents."
            },
            {
                id: 7,
                type: "codeWriting",
                difficulty: "medium",
                category: "javascript",
                topic: "functions",
                question: "Write a function that returns the sum of all numbers in an array:",
                correctAnswer: `function sumArray(arr) {
  return arr.reduce((sum, num) => sum + num, 0);
}`,
                explanation: "The reduce() method is perfect for accumulating values. Start with 0 and add each number to the running sum.",
                analogy: "reduce() is like a snowball rolling downhill - it accumulates more with each element it encounters.",
                teachingTip: "Start by teaching the imperative approach with a for loop, then show how reduce() makes it more functional and concise."
            },
            {
                id: 8,
                type: "terminal",
                difficulty: "easy",
                category: "tools",
                topic: "npm",
                question: "What command installs a package as a development dependency?",
                correctAnswer: "npm install --save-dev [package-name] or npm install -D [package-name]",
                explanation: "Development dependencies are packages only needed during development, not in production.",
                analogy: "Dev dependencies are like your cooking utensils - essential for making the meal, but the customer doesn't need them to enjoy the food.",
                teachingTip: "Explain the difference between dependencies and devDependencies in package.json and when to use each."
            },
            {
                id: 9,
                type: "multipleChoice",
                difficulty: "advanced",
                category: "javascript",
                topic: "async",
                question: "What's the difference between Promise.all() and Promise.allSettled()?",
                options: [
                    "Promise.all() waits for all promises, allSettled() returns immediately",
                    "Promise.all() fails fast on any rejection, allSettled() waits for all to complete",
                    "They are the same, just different names",
                    "Promise.allSettled() only works with async/await"
                ],
                correctAnswer: "Promise.all() fails fast on any rejection, allSettled() waits for all to complete",
                explanation: "Promise.all() rejects immediately if any promise rejects, while Promise.allSettled() waits for all promises to either resolve or reject.",
                analogy: "Promise.all() is like a group project where everyone must succeed, while allSettled() is like collecting all test results regardless of pass/fail.",
                teachingTip: "Use real-world API call examples to show when you'd want fail-fast behavior vs. getting all results."
            },
            {
                id: 10,
                type: "shortAnswer",
                difficulty: "easy",
                category: "react",
                topic: "components",
                question: "Explain the difference between props and state in one sentence:",
                correctAnswer: "Props are read-only data passed from parent to child components, while state is mutable data managed within the component itself.",
                explanation: "Props flow down the component tree and cannot be modified by the receiving component, while state is internal and can be updated.",
                analogy: "Props are like parameters passed to a function, while state is like variables declared inside the function.",
                teachingTip: "Use a form component example - the initial values might come from props, but the current input values are stored in state."
            }
        ];

        // Main App Component
        function App() {
            const [theme, setTheme] = useState('dark');
            const [currentScreen, setCurrentScreen] = useState('welcome');
            const [currentMode, setCurrentMode] = useState('random');
            const [currentQuestion, setCurrentQuestion] = useState(null);
            const [userAnswer, setUserAnswer] = useState('');
            const [showFeedback, setShowFeedback] = useState(false);
            const [isCorrect, setIsCorrect] = useState(false);
            const [stats, setStats] = useState(() => {
                const saved = localStorage.getItem('jsTrainingStats');
                return saved ? JSON.parse(saved) : {
                    totalDaysVisited: 1,
                    currentStreak: 1,
                    lastVisitDate: new Date().toDateString(),
                    questionsAnsweredToday: 0,
                    totalQuestionsAnswered: 0,
                    correctAnswers: 0,
                    incorrectAnswers: 0,
                    reviewLater: []
                };
            });
            const [answeredQuestions, setAnsweredQuestions] = useState([]);
            const [sidebarOpen, setSidebarOpen] = useState(true);

            // Update visit stats
            useEffect(() => {
                const today = new Date().toDateString();
                if (stats.lastVisitDate !== today) {
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    const wasYesterday = stats.lastVisitDate === yesterday.toDateString();
                    
                    setStats(prev => ({
                        ...prev,
                        totalDaysVisited: prev.totalDaysVisited + 1,
                        currentStreak: wasYesterday ? prev.currentStreak + 1 : 1,
                        lastVisitDate: today,
                        questionsAnsweredToday: 0
                    }));
                }
            }, []);

            // Save stats to localStorage
            useEffect(() => {
                localStorage.setItem('jsTrainingStats', JSON.stringify(stats));
            }, [stats]);

            const motivationalQuotes = [
                "Code is like humor. When you have to explain it, it's bad. – Cory House",
                "First, solve the problem. Then, write the code. – John Johnson",
                "Experience is the name everyone gives to their mistakes. – Oscar Wilde",
                "The best way to learn is to teach. – Frank Oppenheimer",
                "Every expert was once a beginner. Keep going! 💪"
            ];

            const getRandomQuote = () => {
                return motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
            };

            const startTraining = () => {
                selectNewQuestion();
                setCurrentScreen('training');
            };

            const selectNewQuestion = (similarTopic = null) => {
                let availableQuestions = questionBank.filter(q => !answeredQuestions.includes(q.id));
                
                if (currentMode === 'easy') {
                    availableQuestions = availableQuestions.filter(q => q.difficulty === 'easy');
                } else if (currentMode === 'advanced') {
                    availableQuestions = availableQuestions.filter(q => q.difficulty === 'advanced');
                } else if (currentMode === 'review') {
                    availableQuestions = questionBank.filter(q => stats.reviewLater.includes(q.id));
                }
                
                if (similarTopic) {
                    const topicQuestions = availableQuestions.filter(q => q.topic === similarTopic);
                    if (topicQuestions.length > 0) {
                        availableQuestions = topicQuestions;
                    }
                }
                
                if (availableQuestions.length === 0) {
                    availableQuestions = questionBank;
                    setAnsweredQuestions([]);
                }
                
                const randomIndex = Math.floor(Math.random() * availableQuestions.length);
                setCurrentQuestion(availableQuestions[randomIndex]);
                setUserAnswer('');
                setShowFeedback(false);
            };

            const handleSubmitAnswer = () => {
                if (!userAnswer.trim()) return;
                
                const correct = checkAnswer();
                setIsCorrect(correct);
                setShowFeedback(true);
                setAnsweredQuestions(prev => [...prev, currentQuestion.id]);
                
                setStats(prev => ({
                    ...prev,
                    questionsAnsweredToday: prev.questionsAnsweredToday + 1,
                    totalQuestionsAnswered: prev.totalQuestionsAnswered + 1,
                    correctAnswers: correct ? prev.correctAnswers + 1 : prev.correctAnswers,
                    incorrectAnswers: correct ? prev.incorrectAnswers : prev.incorrectAnswers + 1,
                    reviewLater: correct 
                        ? prev.reviewLater.filter(id => id !== currentQuestion.id)
                        : [...new Set([...prev.reviewLater, currentQuestion.id])]
                }));
            };

            const checkAnswer = () => {
                const answer = userAnswer.toLowerCase().trim();
                const correct = currentQuestion.correctAnswer.toLowerCase().trim();
                
                if (currentQuestion.type === 'multipleChoice') {
                    return answer === correct;
                } else if (currentQuestion.type === 'codeCompletion') {
                    return answer === correct;
                } else {
                    // For other types, check if answer contains key concepts
                    return answer.includes(correct.substring(0, 20));
                }
            };

            const handleSimilarQuestion = () => {
                selectNewQuestion(currentQuestion.topic);
            };

            const handleNextQuestion = () => {
                selectNewQuestion();
            };

            const toggleTheme = () => {
                setTheme(prev => prev === 'dark' ? 'light' : 'dark');
            };

            const accuracy = stats.totalQuestionsAnswered > 0 
                ? Math.round((stats.correctAnswers / stats.totalQuestionsAnswered) * 100)
                : 0;

            return (
                <div className={`min-h-screen ${theme}`}>
                    <div className={`min-h-screen ${theme === 'dark' ? 'bg-gray-900' : 'bg-gray-50'} transition-colors duration-300`}>
                        {/* Header */}
                        <header className={`${theme === 'dark' ? 'bg-gray-800' : 'bg-white'} shadow-lg border-b ${theme === 'dark' ? 'border-gray-700' : 'border-gray-200'}`}>
                            <div className="px-4 py-3 flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    <button 
                                        onClick={() => setSidebarOpen(!sidebarOpen)}
                                        className="text-2xl hover:opacity-80 transition-opacity"
                                    >
                                        ☰
                                    </button>
                                    <h1 className="text-2xl font-bold bg-gradient-to-r from-blue-400 to-teal-400 bg-clip-text text-transparent">
                                        JS Training Ground
                                    </h1>
                                </div>
                                <div className="flex items-center space-x-4">
                                    <button 
                                        onClick={toggleTheme}
                                        className="text-2xl hover:opacity-80 transition-opacity"
                                    >
                                        {theme === 'dark' ? '🌙' : '☀️'}
                                    </button>
                                    <div className="text-xl">👤</div>
                                </div>
                            </div>
                        </header>

                        <div className="flex h-[calc(100vh-64px)]">
                            {/* Sidebar */}
                            <aside className={`${sidebarOpen ? 'w-64' : 'w-0'} ${theme === 'dark' ? 'bg-gray-800' : 'bg-white'} border-r ${theme === 'dark' ? 'border-gray-700' : 'border-gray-200'} transition-all duration-300 overflow-hidden`}>
                                <div className="p-4 space-y-6">
                                    {/* Mode Selector */}
                                    <div>
                                        <h3 className="font-semibold mb-3 text-teal-400">Training Modes</h3>
                                        <div className="space-y-2">
                                            {['Random', 'Advanced', 'Most Important', 'Easy', 'Review Later'].map((mode) => (
                                                <button
                                                    key={mode}
                                                    onClick={() => {
                                                        setCurrentMode(mode.toLowerCase().replace(' ', ''));
                                                        if (currentScreen === 'training') {
                                                            selectNewQuestion();
                                                        }
                                                    }}
                                                    className={`w-full text-left px-3 py-2 rounded-lg transition-all ${
                                                        currentMode === mode.toLowerCase().replace(' ', '') 
                                                        ? 'bg-teal-500 text-white' 
                                                        : theme === 'dark' 
                                                            ? 'hover:bg-gray-700' 
                                                            : 'hover:bg-gray-100'
                                                    }`}
                                                >
                                                    {mode}
                                                    {mode === 'Review Later' && stats.reviewLater.length > 0 && (
                                                        <span className="ml-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full">
                                                            {stats.reviewLater.length}
                                                        </span>
                                                    )}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Stats */}
                                    <div>
                                        <h3 className="font-semibold mb-3 text-teal-400">Your Stats</h3>
                                        <div className="space-y-2 text-sm">
                                            <div className="flex justify-between">
                                                <span>Total Days:</span>
                                                <span className="font-bold">{stats.totalDaysVisited}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span>Current Streak:</span>
                                                <span className="font-bold streak-fire">
                                                    {stats.currentStreak} 🔥
                                                </span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span>Today:</span>
                                                <span className="font-bold">{stats.questionsAnsweredToday}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span>Accuracy:</span>
                                                <span className="font-bold">{accuracy}%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </aside>

                            {/* Main Content */}
                            <main className="flex-1 overflow-y-auto">
                                {currentScreen === 'welcome' ? (
                                    <div className="flex items-center justify-center h-full p-8">
                                        <div className="text-center max-w-2xl">
                                            <h2 className="text-4xl font-bold mb-6">
                                                Good morning, Emily! ☕
                                            </h2>
                                            
                                            {stats.currentStreak > 1 && (
                                                <div className="mb-6 text-2xl success-animation">
                                                    You're on a {stats.currentStreak}-day streak! 🔥
                                                </div>
                                            )}
                                            
                                            <div className="mb-8 text-lg opacity-80">
                                                <p className="mb-4">Total days visited: {stats.totalDaysVisited}</p>
                                                <p className="italic">"{getRandomQuote()}"</p>
                                            </div>
                                            
                                            <button
                                                onClick={startTraining}
                                                className="px-8 py-4 bg-gradient-to-r from-blue-500 to-teal-500 text-white font-bold text-xl rounded-xl hover:scale-105 transform transition-all shadow-xl"
                                            >
                                                Start Training →
                                            </button>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="flex items-center justify-center h-full p-8">
                                        {currentQuestion && (
                                            <div className={`w-full max-w-3xl ${showFeedback ? 'card-flip' : ''}`}>
                                                <div className={`${theme === 'dark' ? 'bg-gray-800' : 'bg-white'} rounded-xl shadow-2xl p-8`}>
                                                    {!showFeedback ? (
                                                        <>
                                                            {/* Question */}
                                                            <div className="mb-6">
                                                                <div className="flex justify-between items-start mb-4">
                                                                    <span className={`px-3 py-1 rounded-full text-sm ${
                                                                        currentQuestion.difficulty === 'easy' ? 'bg-green-500' :
                                                                        currentQuestion.difficulty === 'medium' ? 'bg-yellow-500' :
                                                                        'bg-red-500'
                                                                    } text-white`}>
                                                                        {currentQuestion.difficulty}
                                                                    </span>
                                                                    <span className="text-sm opacity-60">
                                                                        {currentQuestion.category} / {currentQuestion.topic}
                                                                    </span>
                                                                </div>
                                                                
                                                                <h3 className="text-xl font-semibold mb-4">
                                                                    {currentQuestion.question}
                                                                </h3>
                                                                
                                                                {currentQuestion.codeSnippet && (
                                                                    <div className="code-editor">
                                                                        <pre className="text-teal-400 font-mono text-sm">
                                                                            <code>{currentQuestion.codeSnippet}</code>
                                                                        </pre>
                                                                    </div>
                                                                )}
                                                            </div>

                                                            {/* Answer Input */}
                                                            <div className="space-y-4">
                                                                {currentQuestion.type === 'multipleChoice' ? (
                                                                    <div className="space-y-3">
                                                                        {currentQuestion.options.map((option, index) => (
                                                                            <label 
                                                                                key={index}
                                                                                className={`block p-3 rounded-lg border-2 cursor-pointer transition-all ${
                                                                                    userAnswer === option
                                                                                        ? 'border-teal-500 bg-teal-500 bg-opacity-20'
                                                                                        : theme === 'dark' 
                                                                                            ? 'border-gray-600 hover:border-teal-400' 
                                                                                            : 'border-gray-300 hover:border-teal-400'
                                                                                }`}
                                                                            >
                                                                                <input
                                                                                    type="radio"
                                                                                    name="answer"
                                                                                    value={option}
                                                                                    checked={userAnswer === option}
                                                                                    onChange={(e) => setUserAnswer(e.target.value)}
                                                                                    className="sr-only"
                                                                                />
                                                                                <span>{option}</span>
                                                                            </label>
                                                                        ))}
                                                                    </div>
                                                                ) : currentQuestion.type === 'codeWriting' ? (
                                                                    <div className="monaco-container">
                                                                        <textarea
                                                                            value={userAnswer}
                                                                            onChange={(e) => setUserAnswer(e.target.value)}
                                                                            className={`w-full h-48 p-4 font-mono text-sm rounded-lg ${
                                                                                theme === 'dark' 
                                                                                    ? 'bg-gray-700 text-teal-300' 
                                                                                    : 'bg-gray-100 text-gray-800'
                                                                            } border-2 border-teal-500 focus:outline-none focus:border-teal-400`}
                                                                            placeholder="Write your code here..."
                                                                        />
                                                                    </div>
                                                                ) : (
                                                                    <textarea
                                                                        value={userAnswer}
                                                                        onChange={(e) => setUserAnswer(e.target.value)}
                                                                        className={`w-full h-32 p-4 rounded-lg ${
                                                                            theme === 'dark' 
                                                                                ? 'bg-gray-700' 
                                                                                : 'bg-gray-100'
                                                                        } border-2 border-teal-500 focus:outline-none focus:border-teal-400`}
                                                                        placeholder="Type your answer here..."
                                                                    />
                                                                )}
                                                                
                                                                <button
                                                                    onClick={handleSubmitAnswer}
                                                                    disabled={!userAnswer}
                                                                    className={`w-full py-3 px-6 rounded-lg font-semibold transition-all ${
                                                                        userAnswer 
                                                                            ? 'bg-gradient-to-r from-blue-500 to-teal-500 text-white hover:scale-105' 
                                                                            : 'bg-gray-500 text-gray-300 cursor-not-allowed'
                                                                    }`}
                                                                >
                                                                    Submit Answer
                                                                </button>
                                                            </div>
                                                        </>
                                                    ) : (
                                                        <div className="space-y-6 success-animation">
                                                            {/* Feedback */}
                                                            <div className="text-center">
                                                                {isCorrect ? (
                                                                    <div className="text-4xl mb-4">
                                                                        ✅ Nailed it, Emily! 🎯
                                                                    </div>
                                  
                                                                ) : (
                                                                    <div className="text-4xl mb-4">
                                                                        🤔 Not quite! Here's the thing...
                                                                    </div>
                                                                )}
                                                            </div>
                                                            
                                                            {!isCorrect && (
                                                                <div className={`p-4 rounded-lg ${theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100'}`}>
                                                                    <h4 className="font-semibold mb-2 text-teal-400">Correct Answer:</h4>
                                                                    <p className="mb-4">{currentQuestion.correctAnswer}</p>
                                                                    
                                                                    {currentQuestion.explanation && (
                                                                        <>
                                                                            <h4 className="font-semibold mb-2 text-teal-400">Explanation:</h4>
                                                                            <p className="mb-4">{currentQuestion.explanation}</p>
                                                                        </>
                                                                    )}
                                                                </div>
                                                            )}
                                                            
                                                            <div className={`p-4 rounded-lg ${theme === 'dark' ? 'bg-blue-900 bg-opacity-30' : 'bg-blue-100'}`}>
                                                                <h4 className="font-semibold mb-2 text-blue-400">💡 Analogy:</h4>
                                                                <p>{currentQuestion.analogy}</p>
                                                            </div>